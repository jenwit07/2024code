{"version":3,"file":"index.js","names":["_express","_interopRequireDefault","require","_bodyParser","_cors","_fs","_yaml","_swaggerUiExpress","_dayjs","_path","_helmet","_expressRateLimit","bodyParser","port","app","express","todos","use","json","limit","extended","urlencoded","req","res","next","header","setHeader","cors","helmet","limiter","rateLimit","windowMs","max","message","apiSpec","path","join","__dirname","file","fs","readFileSync","swaggerDocument","YAML","parse","swaggerUi","serve","setup","get","send","status","post","_req$body","body","id","task","newTodo","completed","push","put","params","_req$body2","todo","find","t","filter","err","errors","listen","console","log","concat","dayjs","format","module","exports"],"sources":["../src/index.js"],"sourcesContent":["import express from \"express\";\nimport { json, urlencoded } from \"body-parser\";\nimport cors from \"cors\";\nimport fs from \"fs\";\nimport YAML from \"yaml\";\nimport swaggerUi from \"swagger-ui-express\";\nimport dayjs from \"dayjs\";\nimport path from \"path\";\nimport helmet from 'helmet';\nimport rateLimit from 'express-rate-limit';\n\nconst bodyParser = require(\"body-parser\");\nconst port = 3000;\n\nvar app = express();\nlet todos = [];\n\napp.use(json({ limit: \"50mb\", extended: true }));\napp.use(urlencoded({ limit: \"50mb\", extended: true }));\napp.use((req, res, next) => {\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\n  res.header(\"Access-Control-Allow-Methods\", \"GET,PUT,POST,DELETE,OPTIONS\");\n  res.header(\"Access-Control-Allow-Headers\", \"Content-Type\");\n  res.header(\"Access-Control-Expose-Headers\", \"ETag\");\n  res.setHeader(\"Access-Control-Allow-Credentials\", true);\n  next();\n});\napp.use(cors());\n\napp.use(bodyParser.json());\napp.use(\n  bodyParser.urlencoded({\n    extended: true,\n  })\n);\n\napp.use(helmet());\n\n/* Limit requests from same API */\nconst limiter = rateLimit({\n  windowMs: 60 * 60 * 1000,\n  max: 100,\n  message: 'Too many requests from this IP, please try again after an hour'\n});\napp.use(limiter);\n\n/ * Swagger Documentation and OpenAPI Specification * /\nconst apiSpec = path.join( __dirname ,'api.yaml' );\nconst file  = fs.readFileSync(apiSpec, 'utf8')\nconst swaggerDocument = YAML.parse(file)\napp.use('/api-docs', swaggerUi.serve, swaggerUi.setup(swaggerDocument));\n\napp.get(\"/\", (req, res) => {\n  res.send(\n    `Service is running`\n  );\n});\n\napp.get('/todos', (req, res) => {\n  res.status(200).json(todos);\n});\n\napp.post('/todos', (req, res) => {\n  const { id, task } = req.body;\n  if (!task) {\n    return res.status(400).send('Task is required');\n  }\n  const newTodo = { id, task, completed: false };\n  todos.push(newTodo);\n  res.status(201).json(newTodo);\n});\n\napp.put('/todos/:id', (req, res) => {\n  const { id } = req.params;\n  const { task, completed } = req.body;\n  const todo = todos.find(t => t.id === id);\n  if (!todo) {\n    return res.status(404).send('Todo not found');\n  }\n  todo.task = task ?? todo.task;\n  todo.completed = completed ?? todo.completed;\n  res.status(200).json(todo);\n});\n\napp.delete('/todos/:id', (req, res) => {\n  const { id } = req.params;\n  todos = todos.filter(t => t.id !== id);\n  res.status(204).send();\n});\n\napp.use((err, req, res, next) => {\n  res.status(err.status || 500).json({\n    message: err.message,\n    errors: err.errors,\n  });\n});\n\napp.listen(port, () => {\n  console.log(\n    `#### Stat Time ${dayjs().format(\n      \"DD/MM/YYYY HH:mm:ss\"\n    )} --- Service is running on port ${port}`\n  );\n});\n\nmodule.exports = app;\n"],"mappings":"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"}